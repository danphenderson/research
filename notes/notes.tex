\documentclass[10pt]{article}

\input{preamble.tex}
\usepackage{csquotes} % recommended with biblatex
\usepackage[backend=biber,style=numeric]{biblatex}
\addbibresource{citations.bib}


% ----------------- Document TITLE
\title{Modeling Blood Flow in Macrocirculatory System}
\author{Names Here}
\date{\today}



% ------------------ DOCUMENT START
% -----------------------------------------------------------------
% ------------------
\begin{document} \maketitle

    % ------------------ COVER PAGE
    % -----------------------------------------------------------------
    \noindent Notes pertaining to mathematical models of blood flow in
    the macrocirculatory system. We aim to develop mathematical
    models describing the hemodynamics of arterial and
    large venous segments, then we extend our models to macrocirculation networks
    using a domain decomposition approach.

    \medskip

    \textbf{Keywords:} \textit{computational hemodynamics, 0D blood-flow, 1D blood-flow, 2D-blood-flow, PINN's,
    finite element methods, discontinous galerkin, Lax-Wendroff, fluid-structure ineraction (FSI)}

    \medskip

    \tableofcontents

    \medskip

    \newpage

    % ------------------ SECTION: Preliminaries
    % -----------------------------------------------------------------
    \section{Preliminaries}
        \label{sec:preliminaries}
        \medskip
        \subsection*{Mathematical Notation}
            \begin{minipage}[t]{0.48\textwidth}
                \begin{tabular}{@{}p{0.4\linewidth} p{1.8\linewidth}@{}}
                    $ \R$                             & set of real numbers \\
                    $ \R^{+}$                         & set of positive real numbers \\
                    $ \R^{-}$                         & set of negative real numbers \\
                    $ \R^{n}$                         & n-dimensional real vector space \\
                    $ \Omega \subset \R^{n}$          & a connected open subset of $\R^{n}$ \\
                    $ \OmegaBar$                      & the closure of $\Omega$ \\
                    $ \partial \Omega$                & the boundary of $\Omega$ \\
                    $ dx $                            & Lebesgue measure on $\R^{n}$ \\
                    $ dS $                            & surface measure on $\partial \Omega$ \\
                    $ dV $                            & volume measure on $\Omega$ \\
                    $ \nabla $                        & gradient operator \\
                    $ \del $                          & Laplace operator \\
                    $ \Div $                          & divergence of a vector field \\
                    $ \Divbf $                        & divergence of a tensor \\
                    $ \vct{v}_i$                      & $i$-th component of vector $\vct{v}$ \\
                    $ \langle \cdot, \cdot \rangle_X$ & inner product on vector space $X$ \\
                    $ \langle \vct{u}, \vct{v} \rangle$ & inner product of vectors $\vct{u}, \vct{v} \in \R^n$ \\
                    $ \dfrac{\partial}{\partial \nhat} = \langle \nabla, \nhat \rangle$ & normal derivative on $\partial \Omega$ \\
                    $\| \cdot \|$                     & $L^2$-norm \\
                    $C^{k}(\Omega)$                   & space of $k$ times continuously differentiable functions on $\Omega$ \\
                    $C^{k}_{0}(\Omega)$               & space of $k$ times continuously differentiable functions with compact support in $\Omega$ \\
                    $C^{k}_{0}(\overline{\Omega})$    & space of $k$ times continuously differentiable functions which have bounded and uniformly
                                                        continuous derivatives up to order $k$ with compact support in $\Omega$ \\
                    $C^{\infty}_{0}(\Omega)$          & space of smooth functions with compact support in $\Omega$ \\
                    $L^{p}(\Omega)$                   & Lebesgue space of $p$-integrable functions on $\Omega$ \\
                \end{tabular}
            \end{minipage}\hfill
        \newpage

        \subsection*{Symbols and Abbreviations}
            \label{subsec:symbols}
            \medskip
            \begin{minipage}[t]{0.48\textwidth}
                \begin{tabular}{@{}p{0.4\linewidth} p{1.8\linewidth}@{}}
                    $\therefore$ & consequently\\
                    $\because$ & because\\
                    $\implies$ & implies \\
                    $\iff$ & if and only if \\
                    $:=$ & defines\\
                    $\equiv$ & equivalent \\
                    s.t. & such that \\
                    w.r.t. & with respect to\\
                    m.b.s. & m.b.s.\\
                    a.e. & almost everywhere\\
                    wlog & without loss of generality \\
                    i.e. & "id est" (that means) \\
                    e.g. & "exempli gratia" (for example)\\
                    ODE & Ordinary Differential Equation \\
                    PDE & Partial Differential Equation \\
                    IC & Initial Condition \\
                    BC & Boundary Condition \\
                    0D & Zero dimensional \\
                    1D & One dimensional \\
                    2D & Two dimensional \\
                    3D & Three dimensional \\
                    FSI & Fluid-Structure Interaction \\
                    WHO & World-Health Organization \\
                    SB & Stenotic Bloodflow \\
                    bpm & beats per minute \\
                    RBC & Red Blood Cell \\
                \end{tabular}
            \end{minipage}
        \medskip

        \subsection*{Parameters and Units}
            \label{subsec:params}
            \medskip
            \begin{minipage}[t]{0.48\textwidth}
                \begin{tabular}{@{}p{0.4\linewidth} p{1.8\linewidth}@{}}
                    $\rho$ & density of blood  $\quad \big[ \frac{kg}{m^3} \big]$\\
                    $\eta$ & dynamic viscosity $\quad \big[Pa \cdot s]$ \\
                    $\mu$ & kinematic viscosity $\quad \big[ \frac{m^2}{s} \big]$\\
                    $\tau$ & shear stress \\
                    $\dot{\gamma}$ & shear rate \\
                    $R$ & radius of vessel with diameter $2R$ \\
                    $\vct{u}$ & velocity field \\
                    $p$ & pressure field \\
                    $W_0$ & Womersley number $\big[ - \big]$ \\
                    $Re$ & Reynolds number $\big[ - \big]$ \\
                    $Pe$ & Péclet number $\big[ - \big]$ \\
                \end{tabular}
            \end{minipage}
        \medskip

        \subsection*{Mathematical Notation}
            \label{subsec:params}
            \medskip
            \begin{minipage}[t]{0.48\textwidth}
                \begin{tabular}{@{}p{0.4\linewidth} p{1.8\linewidth}@{}}
                    $\rho$ & density of blood  $\quad \big[ \frac{kg}{m^3} \big]$\\
                    $\eta$ & dynamic viscosity $\quad \big[Pa \cdot s]$ \\
                    $\mu$ & kinematic viscosity $\quad \big[ \frac{m^2}{s} \big]$\\
                    $\tau$ & shear stress \\
                    $\dot{\gamma}$ & shear rate \\
                    $R$ & radius of vessel with diameter $2R$ \\
                    $\vct{u}$ & velocity field \\
                    $p$ & pressure field \\
                    $W_0$ & Womersley number $\big[ - \big]$ \\
                    $Re$ & Reynolds number $\big[ - \big]$ \\
                    $Pe$ & Péclet number $\big[ - \big]$ \\
                \end{tabular}
            \end{minipage}
        \medskip
    \newpage

    % ------------------ SECTION: Introduction
    % -----------------------------------------------------------------
    \section{Introduction}
        \label{sec:introduction}
        \medskip

        Coronary artery stenosis (CAS) is the narrowing of the
        coronary arteries due to the buildup of plaque. This
        narrowing can restrict blood flow to the heart muscle,
        leading to various cardiovascular problems, including
        chest pain (angina), heart attacks, and other serious
        complications. Current methods for predicting coronary
        artery stenosis are rudimentary; and often prediction
        does mean coronary artery stenosis obstruction (\cite{ehab332}).
        There is a need for more accurate and reliable methods
        to predict and assess the severity of CAS.
        narrowing can restrict blood flow to the heart muscle,
        leading to various cardiovascular problems, including
        chest pain (angina), heart attacks, and other serious
        complications. Current methods for predicting coronary
        artery stenosis are rudimentary; and often prediction
        does mean coronary artery stenosis obstruction.
        There is a need for more accurate and reliable methods
        to predict and assess the severity of CAS.

        \subsection{   Physiological Background}
            \label{subsec:physio-background}
            The circulatory system consists of a human's heart,
            vascular network, lungs, and organs. The heart is the source,
            transporting Oxygen-rich blood to the organs and
            deoxygenated (and carbon dioxide-enriched) blood back to the lungs.
            Lungs discharge $CO2$ and enrich the blood with Oxygen. We refer to these
            respective processes as the \emph{pulmonary circulation} and
            the \emph{systemic circulation} (resp.). The \emph{macrocirculatory
            system} consists of the heart and the large vessels in the systemic circulation.
            Particularly, the arteries of the macrocirculatory system transport
            oxygenated blood from the heart, driving the return of deoxygenated blood in
            large vessels back to the heart. Hemodynamics refers to the study of blood flow in
            the circulatory system.

            \medskip

            Cardiovascular disease (CVD) is the leading cause of death in developed nations.
            According to the World Health Organization (WHO), CVD accounts for approximately
            30\% of all global deaths in 2012. Understanding the hemodynamics of the macrocirculatory system is crucial for
            diagnosing, treating, and preventing CVD. Consequently, our motivation is to
            simulate and analyze various cardiovascular conditions, including arterial
            stenosis, aneurysms, and heart valve disorders, with the aim to better enable
            provider treatment. \todo{SEO for insurance companies}

            \medskip

            A single beat of the heart propels blood through the macrocirculatory system,
            the "lub-dub" sound. We refer to the beat and the sequence of events until the
            successive beat as the \emph{cardiac cycle}. The cardiac cycle consists of
            two main phases: systole and diastole, during which the heart chamber is
            accumulating blood and releasing blood (resp.). The beat can be recognized as a pulse
            wave in large vessels, characterized by the Wormersley number $W_0$:
            \begin{flalign*}
                    \quad & W_0 := 2R \cdot \sqrt{\frac{\omega \rho}{\eta}} &&
            \end{flalign*}
            a dimensionless parameter comparing the frequency $\omega$
            of the pulse wave to the blood's kinematic viscosity $\eta$ and the vessel diameter $2R$.
            \begin{definition}
                \label{def:reynolds_number}
                The Reynolds number $Re$ characterizes flow in blood vessels:
                \begin{flalign*}
                        \quad & Re := 2R \cdot \frac{\rho U}{\eta}, \quad : ~ \rho \text{ is fixed blood density}
                \end{flalign*}
                where $U$ is the mean flow velocity.
            \end{definition}
            Low $Re$ indicates laminar flow, while high $Re$ suggests turbulent flow. \todo{what is $\rho$?}

            \medskip

            \subsubsection*{Observed Cardiac Cycle Characteristics}
            Normal resting heart rate is considered to be $\omega = 70$ bpm,
            so the cardiac cycle is approximately $0.86 s.$, consisting of:\\
            1. Systole (ventricular contraction) $\approx 0.3$ seconds.\\
            2. Diastole (ventricular relaxation) $\approx 0.7$ seconds.

            \medskip

            The blood volume of a human is approximately 5.7-6.0 liters of blood,
            flowing a full cycle roughly every minute. The energy driving
            the flow comes from oxygen and nutrients absorbed from food, creating waste
            products that must be removed; the \emph{coronary artery}'s responsibility.
            The buildup of waste products results in Arteriosclerosis, a narrowing of
            the coronary artery, leading to reduced and turbulent blood flow. (Add citations
            here of turbulence in the presence of stenotic arteries).

            \medskip

            \td{Explain Anuerysms and their hemodynamic characteristics}

            \medskip

            \medskip

            \td{Explain Heart valve conditions and there hemodynamic Characteristics}

            \medskip

            Note \autocite[Table~1.1, p.~10, §1.1]{MathematicalEngineering}
            shows $W_0 \propto 2R$ and $Re \propto (2R)^{-1}$; we
            observe large pulses and turbulent flow in large vessels and small pulses
            and laminar flow in small vessels.

            \medskip

            \subsection{Fluid Model of Blood}
                \label{subsec:fluid-model}
                We define the term \emph{domain} as an open, nontrival, bounded, and path-connected subset of $~\R^N :  N \; =  \;1, \, 2, \, 3$.
                Our aim is to model the kinematics of blood on the time interval $[0, T]$ in the lumen $\Omega(t) \subset \R^3$ of a blood vessel:
                \begin{flalign*}
                    \quad \Omega(t) &:= \{ x \in \R^3 ~:~ x \text{ is inside the blood vessel at time } t \},&&
                \end{flalign*}
                Here we say $\Omega(t)$ is the \emph{fluid domain}.

                \medskip

                \begin{definition}
                    \label{def:feilds}
                    Let $\Omega$ be a domain, then if:
                    \begin{flalign*}
                        \quad  f: \Omega \to \R, \quad & \text{then $f$ is a scalar feild.} &&\\
                        \quad  \vct{f}: \Omega \to \R^N, \quad &  \text{then $f$ defines a vector feild.} &&\\
                        \quad  \vct{T}: \Omega \to \R^{N\times N}, \quad &  \text{then $T$ defines a tensor feild},  &&\\
                        \quad & \text{assuming $T$ defines a second-order tensor on $\Omega$.} &&
                    \end{flalign*}
                \end{definition}

                \paragraph{Constituents and hematocrit.}
                Blood consists of plasma and formed elements (cells). Red blood cells (RBCs) comprise
                $\approx 97\%$ of the cellular volume, and cells occupy $\approx 45\%$ of the blood volume.
                The remaining $\approx 55\%$ is plasma, which is $\approx 90\%$ water. The ratio of RBC
                volume to total blood volume is the \emph{hematocrit value} $H$, an important metric
                describing the influence of red blood cells on the flow. Blood viscosity $\eta$
                increases dramatically as $H$ increases (see S6.5.1~\cite{hemodynamics}).


                \medskip

                \paragraph{Modeling framework.}
                In \textit{continuum mechanics}, fluids are modeled by \textit{continuous fields}.
                At \textit{microscopic scales}, our models break down—fluids as fluids are
                discrete collections of molecules, not continuous fields. However, at macroscopic scales we can hope
                that such models remain accurate. We proceed with an overview of the continum hypothesis in the context of blood flow,
                explaining the consequences of assuming that blood is a single-constituent,
                homoegenous, isotropic fluid in domain $\Omega(t)$.
                \todo{cite references that our asssump. holds in the scale of large artiers}
                \todo{explain how isotropic implies Adiabatic}

                \medskip

                Let the blood's velocity, thermodynamic pressure, and density fields be
                \begin{flalign*}
                    \quad & \vct{u}: \Omega(t) \to \R^3, ~ (x, y, z) \mapsto (u_1(x, y, z), ~ u_2(x, y, z), ~u_3(x, y, z))^\top, \quad \bigg[\; \frac{m}{s^2} \;\bigg] && \\
                    \quad & p: \Omega(t) \to \R, ~ (x, y, z) \mapsto p(x, y, z), \quad \bigg[\; \frac{kg}{m^3} \;\bigg]&& \\
                    \quad & \rho: \Omega(t) \to \R^+, ~ (x, y, z) \mapsto \rho(x, y, z).\quad \bigg[\; Pa \equiv \frac{N}{m^2}\;\bigg] &&
                \end{flalign*}
                \td{
                Consider a fluid element $V$, explain how newton's second law implies Euler equations for invcisid
                and incompressible. Then assuming the flow is incompresible,
                we obatin the Cauchy equations for conservation of mass and
                balance of momentum.
                }
                Then the rate-of-deformation tensor is defined as the symmetric part of the velocity gradient,
                \begin{flalign*}
                    \quad \vct{D}(\vct{u}) := \tfrac{1}{2}\big(\nabla\vct{u}+(\nabla\vct{u})^\top\big)
                    \quad \text{s.t.} \quad \nabla\vct{u} := \vect{
                        \dfrac{\partial u_1}{\partial x} & \dfrac{\partial u_1}{\partial y} & \dfrac{\partial u_1}{\partial z} \\
                        \dfrac{\partial u_2}{\partial x} & \dfrac{\partial u_2}{\partial y} & \dfrac{\partial u_2}{\partial z} \\
                        \dfrac{\partial u_3}{\partial x} & \dfrac{\partial u_3}{\partial y} & \dfrac{\partial u_3}{\partial z}
                    }, &&
                \end{flalign*}
                measuring how a continuum of fluid deforms locally under the velocity field $\vct{u}$.
                \begin{definition}
                    \label{def:newtonian-fluid}
                    A fluid is \emph{Newtonian} if its Cauchy stress $\vct{T}\;$ depends
                    linearly on the rate-of-deformation tensor $\vct{D}(\vct{u})$.
                \end{definition}
                \begin{definition}
                    \label{def:isotropic}
                    A fluid is \emph{isotropic} if its constitutive response is independent of the coordinate system.
                    Writing the Cauchy stress as $\vct{T}\;=\vct{T}\;(\vct{D})$,
                    isotropy means that for every orthogonal rotator $\vct{Q}\in\mathrm{SO}(3)$, \todo{remove group ref to SO(3)}
                    \begin{flalign*}
                        \quad & \vct{Q}\, \vct{T}(\vct{D})\,\vct{Q}^{\top} \;=\; \vct{T}\;\!\big(\vct{Q}\,\vct{D}\,\vct{Q}^{\top}\big). &&
                    \end{flalign*}
                \end{definition}
                \begin{definition}[Newtonian, isotropic constitutive law]
                    \label{def:fluidsmodel}
                    For a Newtonian, isotropic fluid the Cauchy stress is
                    \begin{flalign*}
                        \quad & \vct{T} = -\,p\,\mathrm{I} + 2\,\eta\,\vct{D}(\vct{u}) + \lambda\,\Div(\vct{u})\,\mathrm{I}, &&
                    \end{flalign*}
                    where $\eta>0$ is the dynamic (shear) viscosity and $\lambda$ the bulk viscosity.
                \end{definition}
                Note, an isotropic fluid at rest (quiescent state $\vct{u}\equiv\vct{0}$) sustains only
                hydrostatic stress: $\vct{T}=-p\,\mathrm{I}$.
                \begin{definition}[Incompressibile fluid]
                    \label{def:incompressible-fluid}
                    A fluid is \emph{incompressible} if its density is constant in space and time.
                \end{definition}
                \begin{definition}[Incompressible flow]
                \label{def:incompressible-flow}
                    A flow is \emph{incompressible} if density is materially constant
                    in space and time. Let $D_t : = \partial_t + \Div\big((\cdot) \vct{u})$ be the material derivative,
                    then incompressible flow means $D_t(\rho)=0$ in $\Omega(t)$ for all time $t$.
                \end{definition}
                \begin{remark}
                    \label{rmk:incompressibility-divergence-free}
                    By assumption that blood is an incompressible fluid, $\rho\equiv\rho_0>0$ constant.
                    By mass conservation of an incompressible fluid volume, it may be shown that
                    the fluid's flow is incompressible in the sense of Definition~\ref{def:incompressible-flow}.
                    Assuming incompressibility of the fluid and flow, we have the equivalences:
                    \begin{flalign*}
                        \quad & D_t \rho = 0 &&\\
                        \quad & \iff \partial_t \rho + \Div(\rho \vct{u}) = 0 &&\\
                        \quad & \iff \Div(\rho \vct{u}) = 0 \quad (\because ~ \rho \text{ is constant})&&\\
                        \quad & \iff \nabla \cdot (\rho \vct{u}) = 0 &&\\
                        \quad & \iff \langle\rho \vct{u},  \nabla \rangle = 0 &&\\
                        \quad & \iff \rho \langle \vct{u},  \nabla \rangle = 0 &&\\
                        \quad & \iff\langle \vct{u},  \nabla \rangle = 0 \quad (\because ~ \rho > 0) &&\\
                        \quad & \iff \nabla \cdot \vct{u} = 0 &&
                    \end{flalign*}
                    So under incompressibility of the fluid and flow, the
                    divergence-free condition $\Div(\vct{u}) = 0$ of our velocity field holds
                    in $\Omega(t)$. Consequently, the Cauchy stress simplifies to
                    \begin{equation*}
                        \label{def:improssible-stress-tensor}
                        \quad \vct{T} ~ = ~ -\,p\,\mathrm{I} + 2\,\eta\,\vct{D}(\vct{u})
                    \end{equation*}
                \end{remark}
                \begin{remark}[Dynamic vs. Kinematic Viscosity]
                    Throughout assume $\eta \in \R^+$ denote the \emph{dynamic viscosity} of blood, and let $\mu \in \R^+$ denote the \emph{kinematic viscosity}. Then:
                    \begin{flalign*}
                        \quad \mu := \frac{\eta}{\rho} &&
                    \end{flalign*}
                    where $\rho$ is the blood density $\big[\frac{kg}{m^3}\big]$ (assumed constant by incompressibility). Thus:
                    \begin{itemize}
                    \item $\eta$ quantifies the internal resistance of blood to shear deformation, i.e., $\eta := \dfrac{\tau}{\dot{\gamma}}$, with units $[Pa \cdot s]$;
                    \item $\mu$ adjusts $\eta$ by the density $\rho$, capturing the viscous diffusion of momentum per unit mass, with units $\big[\frac{m^2}{s}\big]$.
                    \end{itemize}
                    Intuitively, $\eta$ measures how "thick" or "sticky" the fluid is, while $\mu$ measures how quickly momentum diffuses through the fluid due to viscosity.
                \end{remark}
                \todo{How do we conclude now that $\eta$ is constant, so $\mu$ is constant? Confirm this follows from Newtonian assumption.}
                We will model blood as Newtonian in large arteries by taking $\eta$ constant
                (so $\mu=\eta/\rho$ constant). When diameter $d$ and hematocrit effects are needed, we use a
                relative viscosity $\eta_r(H,d)$ that scales an absolute baseline $\eta$:
                \begin{flalign*}
                    \eta_{\mathrm{eff}} \;=\; \eta_r(H,d)\,\eta
                \end{flalign*}
                An empirical fit (e.g.\ \cite{bviscosity}) is
                \begin{equation}
                \label{eq:relative_viscosity}
                \eta_r \;=\; 1 + (\eta_{0.45}-1)\,
                \frac{(1-H)^{C}-1}{(1-0.45)^{C}-1},
                \qquad
                \begin{cases}
                    \eta_{0.45} = 6\,e^{-0.085\,d} + 3.2 - 2.44\,e^{-0.06\,d^{0.645}},\\[3pt]
                    C = \big(0.8 + e^{-0.075\,d}\big)\!\left(-1 + \dfrac{1}{1 + 10^{-11}\,d^{12}}\right)
                        + \dfrac{1}{1 + 10^{-11}\,d^{12}},
                \end{cases}
                \end{equation}
                where $d : = 2R/(1.0 \mu m)$ is the (scaled) vessel diameter.
                In large vessels, $\eta_r$ is often constant, justifying the Newtonian assumption.
            \medskip
        \medskip

        \subsection{Navier Stokes System}
            \label{subsec:intro-navier-stokes}

            The Navier-Stokes (NS) system in conservative form:
            \begin{definition}[Incompressible-Newtonian NS (Conservative Form)]
                \label{def:NSEquations}
                \begin{flalign*}
                    \quad & \begin{cases*}
                    \quad \rho\big(\partial_t \vct{u} + (\vct{u}\cdot\nabla)\vct{u}\big) = -\,\nabla p \;+\; \Divbf\!\Big( 2\,\mu(|\vct{D}|^2)\,\vct{D}\Big) \;+\; \rho\,\vct{f} \\
                    \quad \Div(\vct{u}) = 0,
                    \end{cases*} &&
                \end{flalign*}
                where $\vct{f}$ is an external force field (e.g., gravity),
            \end{definition}

            We rewrite Eq. \ref{def:NSEquations} in standard form (as found in
            \cite{ns-formulation}, \cite{MathematicalEngineering}.)
            \begin{definition}
                \label{def:standard-form-ns}
                \begin{flalign*}
                    \quad &\rho\big(\partial_t \vct{u} + (\vct{u}\cdot\nabla)\vct{u}\big) = -\,\nabla p \;+\; \Divbf\!\Big( 2\,\mu(|\vct{D}|^2)\,\vct{D}\Big) \;+\; \rho\,\vct{f}&&\\
                    \quad &\iff \rho\big(\partial_t \vct{u} \;+\; (\vct{u}\cdot\nabla)\vct{u}\big) \;=\; -\,\nabla p \;+\; \Divbf\!\Big( 2\,\frac{\eta}{\rho}(|\vct{D}|^2)\,\vct{D}\Big) \;+\; \rho\,\vct{f} &&\\
                    \quad &\iff \rho\big(\partial_t \vct{u} \;+\; (\vct{u}\cdot\nabla)\vct{u}\big) \;=\; -\,\nabla p \;+\; \eta ~ \Divbf\!\Big( 2\,\frac{1}{\rho}(|\vct{D}|^2)\,\vct{D}\Big) \;+\; \rho\,\vct{f} \quad (\because ~\eta = \frac{\mu}{\rho} = \text{const.}) &&\\
                    \quad &\iff \rho\big(\partial_t \vct{u} \;+\; (\vct{u}\cdot\nabla)\vct{u}\big) \;=\; -\,\nabla p \;+\; \mu\;\rho ~ \Divbf\!\Big( 2\,\frac{1}{\rho}(|\vct{D}|^2)\,\vct{D}\Big) \;+\; \rho\,\vct{f} &&\\
                    \quad &\iff \partial_t \vct{u} \;+\; (\vct{u}\cdot\nabla)\vct{u} \;=\; -\,\frac{\nabla p}{\rho} \;+\; \mu\; ~ \Divbf\!\Big( 2\,\frac{1}{\rho}(|\vct{D}|^2)\,\vct{D}\Big) \;+\; \,\vct{f} && \\
                    \quad &\iff \partial_t \vct{u} \;+\;  (\vct{u}\cdot\nabla)\vct{u} \;+\; \frac{\nabla p}{\rho}  \;-\;  \Divbf\!\Big( \frac{2}{\rho}\;\mu\;(|\vct{D}|^2)\,\vct{D}\Big) \;=\; \,\vct{f} && \\
                    \quad &\iff F\!\big(\partial_t\vct{u},\,\nabla\vct{u},\,\nabla p,\, \vct{u},\, p;\, \rho, \mu\big) \;=\; \vct{f}&&
                \end{flalign*}
            \end{definition}
            \begin{remark}
                \label{classifying NS}
                The NS system~\ref{def:NSEquations} is a non-linear coupled system of PDEs.
                \medskip
                The first equation expresses the conservation of linear momentum,
                as derived from Newton's second law, where
                \begin{itemize}
                    \item  $\rho (\vct{u}\cdot\nabla)\vct{u} = \rho \vect{
                        \langle \vct{u}, \nabla \vct{u}_1 \rangle\\
                        \langle \vct{u}, \nabla \vct{u}_2 \rangle\\
                        \langle \vct{u}, \nabla \vct{u}_3 \rangle
                    }$ is the convective acceleration term (non-linear),
                    \item $\Divbf\!\Big( 2\,\mu(|\vct{D}|^2)\,\vct{D}\Big)$ is the viscouselastic and diffusive term (linear if $\mu$ constant).
                \end{itemize}
                The second equation is the continuity equation, a consequence of the assumed fluid properties of blood.
                The total system comprises of four equations in four unknowns: the three components of the velocity field
                $\vct{u}$ and the pressure field $p$.
            \end{remark}
            We will seek solutions of Eq.~\ref{def:NSEquations} to an initial value problem.
            \begin{definition}
                \label{def:init_condition}
                Let $\vct{u_0} : \Omega(0) \to R^3, ~ \vct{x} \mapsto \vct{u_0}(x) ~ : ~ u(0, \vct(x)) = \vct{u_0}$.
                We refer to $\vct{u_0}$ as the initial condition of velocity feild $\vct{u}$
            \end{definition}
            In practice, $\vct{u_0}$ may be prescribed or determined from sensor data.

            \medskip

            To model non-Newtonian effects (when $\eta \neq \text{ constant}$), the kinematic viscosity
            $\mu(\cdot)$ is often chosen by Careau model \cite{hemodynamics}
            \begin{flalign*}
                \quad 2\,\mu(|\vct{D}|^2) = \eta_\infty + (\eta_0 - \eta_\infty) \cdot \big(1 + \kappa |\vct{D}|^2\big). &&
            \end{flalign*}
            Where $\eta_0$ and $~\eta_\infty$ are chosen to be the viscosity for very small
            and very large shear rates, resp., and $\kappa \in \R^+$ and $n \in (-0.5, 0)$ are model parameters.
            According to \cite{MathematicalEngineering}, we often set
            \begin{flalign*}
                \quad \eta_0 = 65.7 \cdot 10^{-3} ~Pa \cdot s, ~ \eta_\infty = 4.45\cdot10^{-3} ~Pa \cdot s,
                    \kappa = 212.2 ~s^2, ~ \text{ and } n = -0.325 &&
            \end{flalign*}
            In a Newtonian case, one often chooses $\mu(|\vct{D}|^2) = \eta_\infty$ (\cite{MathematicalEngineering}, pg. 38).

            \medskip

            If pressure $P$ and the velocity $\vct{u}$ are given,
            the Caucy stress $\vct{T}$ is computed from Eq.~\ref{def:improssible-stress-tensor}.
            The wall shear stress (WSS) at the vessel wall is:

            \begin{flalign*}
                \quad \text{WSS} \; := \; \langle \vct{t_{blood}}, ~\vct{T}\;\hat{n} \rangle \quad : \quad \begin{cases*}
                    t_{blood} \text{ is tangent of a flow line through a cross-sectional area} \\
                    \hat{n} \text{ is outer normal of the cross-sectional area}
                \end{cases*}&&
            \end{flalign*}

            Forgoing the rigid-wall assumption allows us to model the relationship
            between the vessel wall and blood flow. Applicable models are reffered
            to as fluid-structure interaction (FSI) models.\todo{discuss in a later section}


            \subsubsection{NS in Cylindrical Coordinates}
                \label{subsubsec:cylindrical-coords}

                Let our vessel wall $\partial \Omega$ be a surface in $\R^3$
                that evolves in time which we refer to as the interface.
                Let $\OmegaBar = \partial \Omega \cup \Omega$ be the closed and compact
                region enclosed by our interface. So the region enclosed by our interface
                is $\Omega$, and we aim to model the velocity and pressure fields on $\Omega$.\\

                The relationship between cartesian and cylidrical coordinates is
                \begin{flalign*}
                    \quad (x, ~y, ~z) ~ \mapsto (r \sin(\theta), ~ r\cos(\theta), ~z), \quad r = \sqrt{x^2 + y^2}.&&
                \end{flalign*}
                Assume a vessel of length $L$ is aligned with the z-axis
                whose cross-section is circular with radius $R(z,t)$ at axial position $z$ and time $t$.
                Our fluid domain becomes
                \begin{equation*}
                    \label{fluid-domain-cylidrical}
                    \Omega(t) \; = \; \{(r, ~,\theta ~, z) \in \R^3 ~ : ~r \in [0, R(z, t)], ~ \theta \in [0, 2\pi), ~ z \in [0, l) \}
                \end{equation*}
            \medskip
        \medskip
    \newpage

    \section{Mathematical Models of Blood Flow}
        \label{sec:math-models}
        \medskip

        One chooses a model based upon the specific application, computational resources,
        and desired accuracy. We construct models of blood flow in
        various geometries, starting from a single vessel, then extendind our approach to
        bifurcations and arterial networks. Our strategy involves a \emph{domain decomposition approach}.

        \medskip

        \subsection{Dimension-Reduced Models of Blood Flow}
            \label{subsec:dim-reduced-models}

            We start our disscusion with 1D and 0D models, reducing the
            d.o.f. in the NS system~\ref{def:NSEquations} by imposing further
            simplifying assumptions.
            \medskip

            \subsubsection{1D Models}
                \label{subsubsec:1D}
                By averaging pressure and blood velocity on slice of a vessel,
                we consider the flow through each cross-section, leading to a
                model of the flow along the length of the vessel. Because our model
                averages pressure and velocity over a surface-area, we obtain
                a uniform distibution of WSS on the vessel. There are various
                approaches to deriving a 1D model:
                \begin{enumerate}
                    \item Assume $R << \ell$, e.g., (ref dimension reduced paper)
                    \item Integrating the NS system~\ref{def:NSEquations} in a compliant
                    vessel.
                    \item A simplification of the reynolds equation (\ref{}, Chap. 10, \ref{}, \ref{})
                \end{enumerate}
                \begin{figure}[!htb]
                    \label{fig:compliant-vessel}
                    \centering
                    \captionsetup{aboveskip=2pt,belowskip=2pt}
                    \includegraphics[width=0.9\linewidth,height=0.35\textheight,keepaspectratio]{compliant-vessel.png}
                    \caption{From \cite{MathematicalEngineering} [Fig. 3.2, pg. 37]}
                \end{figure}
                \newpage
                Assume the vessel under study may be transformed to a simplified
                geometry as displayed in Figure~\ref{fig:compliant-vessel}. One may start by
                introducing a rigid-vessel assumption, which leads to a no slip condition
                that $\vct{u} \big|_{\partial\Omega} \; = \; \vct{0}$. Instead we seek
                to model the link between blood flow and the deformation of the vessel wall.

                \medskip


                Let $V(t) \subset \Omega(t)$ be a material fluid element of the vessel $\OmegaBar(t)$
                such that $\partial V(t) \subset \partial \Omega(t)$, i.e., $V(t)$ is on the
                the vessel wall. According to the Reynold's transport theorem for $f \in L^1(\Omega(t))$
                \begin{flalign*}
                    \quad \dfrac{d}{dt} \int_{V_t} f dV \;
                        = \; \int_{V(t)} \dfrac{\partial f }{\partial t} dV \;
                        + \; \int_{\partial V(t)}  (\vct{u_b} \cdot \nhat) f dS &&
                \end{flalign*}
                where $\vct{u_b}$ is the velocity feild deforming the boundary $\partial V(t)$
                (Pf. see \href{https://en.wikipedia.org/wiki/Reynolds_transport_theorem}{wiki}).
                If we assume the normal component of $\vct{u_b} = \vct{0}$ near the inlet
                and outlet boundaries $S_1$ and $S_2$ (resp.) of $\Omega$, then the motion of the vessel wall
                is coupled to the blood flow through the fluid element $V(t)$. The velocity $\vct{u_b}$
                is equivalent to the velocity of the vessel wall $\partial \Omega(t)$ in contact with the boundary element $\partial V(t)$.
                I.e., the vessel wall velocity $\vct{u_w} = \vct{u_b}$.
                Now let $\vct{w} = \vct{u_w} - \vct{u}$ be the relative velocity of the vessel wall
                w.r.t. the velocity $\vct{u} = (u_1, u_2, u_3)^\top$ of the blood element $V(t)$. Then it follows that
                \begin{flalign*}
                    \quad \; \int_{\partial V(t)} \big(\vct{u_b} \cdot \nhat \big)f \; dS ~
                        & = ~ \; \int_{\partial V(t)} \big(\vct{u_w} \cdot \nhat \big)f \; dS &&\\
                    \quad \; & = \; \int_{\partial V(t)} \big(\vct{w} \cdot \nhat \big)f \; dS
                        ~ + ~ \; \int_{\partial V(t)} \big(\vct{u} \cdot \nhat \big)f \; dS &&\\
                \end{flalign*}
                Let $\bar{f}$ denote the average value of $f$ defined over a surface $S$
                \begin{flalign*}
                    \quad \bar{f} \; := \; \frac{1}{A} ~ \int_{S(z, t)} f \;dS\quad :  \quad  A(z, t) \; := \; \int_{S(z, t)} dS &&
                \end{flalign*}
                No we may rewrite the volume integral in the LHS of RT theorem
                \begin{flalign*}
                    \quad  \int_{V_t} f dV \; = \; \int_{z_1}^{z_2} \int_{S(z, t)} f \;dS \; dz
                        \;=\; \int_{z_1}^{z_2} A \cdot \bar{f} \; dz &&
                \end{flalign*}
                where $z_1 < z_2$ are fixed $z$-coordinates for $S_1$ and $S_2$.
                Then we differentiate the integrands in the above equation w.r.t. $t$
                \begin{flalign*}
                    \quad \int_{V(t)} \dfrac{\partial f}{\partial t} dV \;=\; \int_{z_1}^{z_2} \dfrac{\partial}{\partial t} \bigg[A \cdot \bar{f} \bigg]\; dz, &&
                \end{flalign*}
                and we've rewritten the first term in the RHS of the reynolds system.
                The surface integral in the RHS may be written as
                \begin{flalign*}
                    \quad \int_{\partial V(t)}  (\vct{u_b} \cdot \nhat) f dS = \int_{\partial V(t)}  (\vct{u_b} \cdot \nhat) f dS.... &&
                \end{flalign*}\todo{cleanup, ref. pg. 43}
                With a little more work, one may obtain:
                \begin{definition}
                    \label{def:1dReynolds}
                    The 1D Reynolds Transport theorem for both compressible and incompressible fluids:
                    \begin{flalign*}
                        \quad \frac{\partial }{\partial t} \bigg( A \bar{f} \bigg) \; + \; \frac{\partial}{\partial z}\big( A (\overline{f \cdot u_3}) \big)
                        \; = \; \int_S \bigg( \dfrac{\partial f}{\partial t} + \nabla \cdot (f \vct{u}) \bigg) dS
                        \; + \; \int_{\partial S} f \vct{w} \cdot \nhat \; d \gamma &&
                    \end{flalign*}
                \end{definition}

                \begin{remark}
                    \label{1DMassConservation}
                    By taking $f = \rho$ in \ref{def:1dReynolds}, mass conservation follows directly. Also, by our assumption
                    that blood is incompressible, we have $\begin{cases*}\Div(\vct{u}) = 0\\\rho =\text{const.}\\
                    \end{cases*}$ and we simplify \ref{def:1dReynolds} as
                    \begin{flalign*}
                        \quad \frac{\partial A }{\partial t} \; + \; \frac{\partial}{\partial z}\big( A (\overline{u_3}) \big)
                        \; = \; \int_{\partial S} \vct{w} \cdot \nhat \; d \gamma &&
                    \end{flalign*}
                    The RHS term above describing the transport process across the vessel wall. \todo{complete, pg. 45}
                \end{remark}

                \begin{remark}
                    \label{1DMomentumConservation}
                    By taking $f = u_3$ in \ref{def:1dReynolds}, momentum conservation follows directly. Also,
                    by our assumption that blood is incompressible, we simplify \ref{def:1dReynolds} as
                    \begin{flalign*}
                        \quad \frac{\partial }{\partial t} \bigg( A u_3 \bigg) \; + \; \frac{\partial}{\partial z}\big( A (\overline{u_3^2}) \big)
                        \; = \; \int_S \bigg( \dfrac{\partial u_3}{\partial t} + \nabla u_3 \cdot \vct{u} \bigg) dS
                        \; + \; \int_{\partial S} u_3 \vct{w} \cdot \nhat \; d \gamma &&
                    \end{flalign*}
                    The RHS term above describing the transport process across the vessel wall.
                \end{remark}












            \subsubsection{0D Models}
                \label{subsubsec:0D}


                The 0D model, on the other hand, treats the vessel as a lumped parameter system,
                focusing on overall pressure and flow relationships without spatial resolution.


    \section{Numerical Methods for Blood Flow Simulation}
        \label{sec:num-methods}
        \medskip
        Numerical methods for PDEs, or \emph{schemes}, are generally of the form:

        To ensure converge of our schemes, we choose an initial condition
        by solving the homogenous-stationary NS problem in standard
        form~\ref{def:NSEquations}:
        \begin{definition}[Stationary Stokes Problem]
            \label{def:stationary-ns}
            \begin{flalign*}
                \quad \begin{cases*}
                - \Divbf(\mu \vct{D}(\vct{u_0})) + \nabla p \; = \; \vct{f}, \\
                \Div(\vct{u_0})\; = \;0
            \end{cases*}\quad \text{ in } \Omega(t) &&
            \end{flalign*}
            and we seek a strong solution .
            We take the $\vct{f} \equiv \vct{0}$ with
        \end{definition}

         Let
         \begin{flalign*}
            \quad \begin{cases*}
                S_0 \; := \; S(0, t) \quad \text{be the inlet}\\
                S_T \; := \; S(\ell, t) \quad \text{be the outlet}
            \end{cases*} \quad \forall ~ t \in [0, T]&&
        \end{flalign*}

        Suitable boundary conditions are, e.g., $S_0$ m.b. a time-dependent velocity or pressure profile
        and the outlet $S_T$ m.b. WSS stress values, as determined from a pressure and velocity profile.

        \bigskip

        \todo{
            Provide an overview of the different numerical methods used for blood flow simulation,
            including finite element methods (FEM), finite volume methods (FVM), and computational fluid dynamics (CFD) approaches.
            Discuss the advantages and limitations of each method.
        }

    \newpage

    % ------------------ SECTION: Coronary Artery Stenosis (CAS)
    % -----------------------------------------------------------------
    \section{Misc}
        \label{sec:cas}

        Coronary artery stenosis (CAS) is the narrowing of the
        coronary arteries due to the buildup of plaque. This
        narrowing can restrict blood flow to the heart muscle,
        leading to various cardiovascular problems, including
        chest pain (angina), heart attacks, and other serious
        complications. Current methods for predicting coronary
        artery stenosis are rudimentary; and often prediction
        does mean coronary artery stenosis obstruction (\cite{ehab332}).
        There is a need for more accurate and reliable methods
        to predict and assess the severity of CAS.
        narrowing can restrict blood flow to the heart muscle,
        leading to various cardiovascular problems, including
        chest pain (angina), heart attacks, and other serious
        complications. Current methods for predicting coronary
        artery stenosis are rudimentary; and often prediction
        does mean coronary artery stenosis obstruction.
        There is a need for more accurate and reliable methods
        to predict and assess the severity of CAS.

        \bigskip

        We perform a literature survey of arterial blood flow using known
        methods from the literature, with the hope of understanding the
        computational challenges and tradeoffs of various \emph{mathematical models}.

        \bigskip


        \todo{
            Make some comment about "correct terminology for describing the
            types of coronary arterial stenosis is "coronary artery stenosis morphology." and ref
            figures in DOI: 10.1056
        }

        \todo{
            Understand Dr. Zhou's statement: Regarding the assumption about the absence
            of a vortex, I cannot definitively say whether it is correct or not. Please review
            the references provided. If needed, we can discuss this further with interventional
            cardiologists.
        }
        \medskip
        \subsubsection{Existence and Uniqueness of NS}
            \label{sec:existenceUniqueness}

            \begin{remark}[Global Regularity Problem for (NS)]\
                \label{rem:global-regularity}
                \textit{For any smooth, spatially localized initial data $ \mathbf{u}_0 $,
                does there exist a global smooth solution $ (\mathbf{u}, p) $ to NS~\ref{def:NSEquations}
                Such question is one of the Millennium Prize Problems posed
                by the Clay Mathematics Institute in 2000, with a prize of one million
                dollars for a correct solution.}
            \end{remark}

            \begin{theorem}[Local Existence and Uniqueness]
                \label{thm:local-existenceUniqueness}
                Given smooth, localized initial data $\vct{u}_0$, there exists a maximal time $0 < T_* \leq \infty$
                for which a unique solution exists.
            \end{theorem}

            \medskip

            If $T_* < \infty$, a \textbf{blow-up} occurs:
            \begin{flalign*}
                \quad & \sup_{x \in \mathbb{R}^3} |\mathbf{u}(t, x)| \to +\infty \quad \text{as} \quad t \to T_*. &&
            \end{flalign*}
            Otherwise, if $T_* = \infty$, then $|\vct{u}| \to 0$ as $t \to \infty$. Numerical evidence suggests global regularity
            holds in most practical cases, but turbulent behavior can emerge for large initial data.

        \medskip

        \subsubsection*{Heuristic Considerations and Energy Balance}
            Starting from the incompressibility condition:
            \begin{flalign*}
                \quad & \Div(\vct{u}) = 0 && \\
                \quad & \iff ~ \rho \text{ is constant in } \Omega(t) && \\
                \quad & \iff ~ \text{ chain rule applies to } \Divbf\big(\frac{2}{\rho} \mu (|\vct{D}|^2) \vct{D}\big) &&\\
                \quad \implies &  \Divbf\big(\frac{2}{\rho} \mu (|\vct{D}|^2) \vct{D}\big) = \nabla \cdot \big(\frac{2}{\rho} \mu (|\vct{D}|^2) \vct{D}\big)&&\\
                \quad & = \langle\frac{2}{\rho} \mu (|\vct{D}|^2) \vct{D}, \nabla \rangle&&\\
                \quad  & = \frac{2}{\rho} \langle \mu (|\vct{D}|^2) \vct{D}, \nabla \rangle&&\\
                \quad & = \frac{2}{\rho} \nabla \cdot \big( \mu (|\vct{D}|^2) \vct{D}\big)&&\\
                \quad & \therefore \quad \frac{2}{\rho}~ \Divbf\big( \mu (|\vct{D}|^2) \vct{D}\big) = 0.&&
            \end{flalign*}
            This vanishes if $\mu$ is constant (Newtonian fluid) and $\rho$ is constant (incompressibility).
            So the diffusive term becomes:
            \begin{flalign*}
                \quad \frac{2\eta}{\rho} \Delta \vct{u}, \quad \text{with } \eta = \mu \rho.&&
            \end{flalign*}\todo{show simplification of diffusive term to laplacian}
            We heuristically compare dominant terms:
            \begin{enumerate}
                \item If $\eta \Delta \vct{u} \gg (\vct{u} \cdot \nabla) \vct{u}$, viscous dissipation dominates $\Rightarrow$ smooth, regular behavior.\
                \item If $(\vct{u} \cdot \nabla) \vct{u} \gg \eta \Delta \vct{u}$, nonlinearity dominates $\Rightarrow$ turbulence, potential blow-up.
            \end{enumerate}
            We construct rigorous energy estimates in Section~\ref{sec:math-models}.
        \medskip

    % ------------------ SECTION: Appendix
    % -----------------------------------------------------------------
    \newpage
    \section{Appendix}
        \label{sec:appendix}
        \medskip

        \printbibliography


        % ------------------ BIBLIOGRAPHY
        \subsection*{References}
            \label{sec:bibliography}
            \medskip

        \medskip

        % ------------------- Code Listings
        \subsection*{Code Listings}

        \td{Optional Space for sumplementary code listings of computations done while investigating}
        \lstset{language=julia}
        \begin{lstlisting}[language=julia, caption={Algorithm 16.5}, label={lst:problem-sampling}]
        function foo()
            println("Hello World)
        end
        \end{lstlisting}



\end{document}
